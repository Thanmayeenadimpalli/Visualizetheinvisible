<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Binary Search - Bouquet Problem</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
    
    .scale-in {
      animation: scaleIn 0.4s ease-out;
    }
    
    .bounce-animate {
      animation: bounce 0.6s ease-in-out;
    }
    
    .pointer-arrow {
      position: relative;
    }
    
    .pointer-arrow::after {
      content: '‚ñº';
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 20px;
      animation: bounce 1s infinite;
    }
    
    .day-cell {
      transition: all 0.3s ease;
    }
    
    .day-cell:hover {
      transform: translateY(-3px);
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .card-shadow {
      box-shadow: 0 10px 30px rgba(63, 34, 90, 0.137);
    }
    
    .flower-bloom {
      filter: drop-shadow(0 0 8px rgba(255, 182, 193, 0.6));
    }
    @keyframes giveBouquet {
  0%   { transform: scale(0.6) translateY(20px); opacity: 0; }
  50%  { transform: scale(1.1) translateY(-5px); opacity: 1; }
  100% { transform: scale(1) translateY(0); }
}

.girl-animate {
  animation: giveBouquet 0.8s ease-out;
}

  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full"></div>
  <script>
  const defaultConfig = {
  background_color: "#1a1a2e",
  surface_color: "#16213e",
  text_color: "#f5f3ff",
  primary_action_color: "#e94560",
  secondary_action_color: "#2b1b3f",
  font_family: "Times New Roman",
  font_size: 16,
  main_title: " Binary Search: Bouquet Problem",
  problem_label: "Find Minimum Days to Make Bouquets",
  start_button: "üöÄ Start Search",
  next_button: "‚è≠Ô∏è Next Step",
  reset_button: "üîÑ Reset"
};


    
    let config = { ...defaultConfig };
    let currentStep = 0;
    let algorithmState = null;
    
    function initializeUI() {
      const app = document.getElementById('app');
      const baseFontSize = config.font_size || defaultConfig.font_size;
      const customFont = config.font_family || defaultConfig.font_family;
      const fontStack = `${customFont}, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;
      
      app.innerHTML = `
        <div class="w-full h-full overflow-auto" style="background: linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, ${config.secondary_action_color || defaultConfig.secondary_action_color} 100%); font-family: ${fontStack};">
          <div class="max-w-7xl mx-auto p-6">
            
            <!-- Header -->
            <header class="text-center mb-8 fade-in">
              <h1 id="main-title" class="font-bold mb-3" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 2.5}px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                ${config.main_title || defaultConfig.main_title}
              </h1>
              <p id="problem-label" class="font-medium" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.2}px;">
                ${config.problem_label || defaultConfig.problem_label}
              </p>
            </header>
            
            <!-- Input Section -->
            <div class="card-shadow rounded-2xl p-6 mb-6 fade-in" style="background-color: ${config.surface_color || defaultConfig.surface_color};">
              <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                <div>
                  <label class="block mb-2 font-semibold" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 0.9}px;">
                    üå∏ Bloom Days
                  </label>
                  <input type="text" id="bloomDays" value="7,7,7,7,12,7,7" 
                    class="w-full px-4 py-3 rounded-lg border-2 focus:outline-none"
                    style="background-color: ${config.background_color || defaultConfig.background_color}; color: ${config.text_color || defaultConfig.text_color}; border-color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize}px;">
                </div>
                <div>
                  <label class="block mb-2 font-semibold" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 0.9}px;">
                    üíê Bouquets (m)
                  </label>

                  <input type="number" id="bouquets" value="2"
                    class="w-full px-4 py-3 rounded-lg border-2 focus:outline-none"
                    style="background-color: ${config.background_color || defaultConfig.background_color}; color: ${config.text_color || defaultConfig.text_color}; border-color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize}px;">
                </div>
                <div>
                  <label class="block mb-2 font-semibold" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 0.9}px;">
                    üå∫ Adjacent (k)
                  </label>
                  <input type="number" id="adjacent" value="3"
                    class="w-full px-4 py-3 rounded-lg border-2 focus:outline-none"
                    style="background-color: ${config.background_color || defaultConfig.background_color}; color: ${config.text_color || defaultConfig.text_color}; border-color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize}px;">
                </div>
                <div class="flex items-end">
                  <button id="startBtn" class="w-full px-6 py-3 rounded-lg font-bold transition-all hover:scale-105"
                    style="background-color: ${config.primary_action_color || defaultConfig.primary_action_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px; box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);">
                    ${config.start_button || defaultConfig.start_button}
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Visualization Area -->
            <div id="visualArea" class="hidden">
              
              <!-- Step Counter -->
              <div class="text-center mb-6">
                <div class="inline-block px-8 py-4 rounded-full card-shadow scale-in"
                  style="background-color: ${config.primary_action_color || defaultConfig.primary_action_color};">
                  <span id="stepCounter" class="font-bold" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 1.5}px;">
                    Step 0
                  </span>
                </div>
              </div>
              
              <!-- Search Range Visualization -->
              <div class="card-shadow rounded-2xl p-6 mb-6 fade-in" style="background-color: ${config.surface_color || defaultConfig.surface_color};">
                <h2 class="font-bold mb-4 flex items-center gap-2" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 1.5}px;">
                  <span></span> Search Range
                </h2>
                <div id="searchRange" class="mb-6"></div>
                
                <div class="grid grid-cols-3 gap-4 text-center mb-4">
                  <div class="p-3 rounded-lg" style="background-color: ${config.background_color || defaultConfig.background_color};">
                    <div style="color: ${config.text_color || defaultConfig.text_color}; opacity: 0.7; font-size: ${baseFontSize * 0.85}px;">Left</div>
                    <div id="leftVal" class="font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.3}px;">-</div>
                  </div>
                  <div class="p-3 rounded-lg" style="background-color: ${config.background_color || defaultConfig.background_color};">
                    <div style="color: ${config.text_color || defaultConfig.text_color}; opacity: 0.7; font-size: ${baseFontSize * 0.85}px;">Mid</div>
                    <div id="midVal" class="font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.3}px;">-</div>
                  </div>
                  <div class="p-3 rounded-lg" style="background-color: ${config.background_color || defaultConfig.background_color};">
                    <div style="color: ${config.text_color || defaultConfig.text_color}; opacity: 0.7; font-size: ${baseFontSize * 0.85}px;">Right</div>
                    <div id="rightVal" class="font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.3}px;">-</div>
                  </div>
                </div>
                
                <div id="stepExplanation" class="p-4 rounded-lg" 
                  style="background-color: ${config.background_color || defaultConfig.background_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px;">
                </div>
              </div>
              
              <!-- Flower Garden -->
              <div class="card-shadow rounded-2xl p-6 mb-6 fade-in" style="background-color: ${config.surface_color || defaultConfig.surface_color};">
                <h2 class="font-bold mb-4 flex items-center gap-2" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 1.5}px;">
                  <span>üå∑</span> Flower Garden at Day <span id="currentDay" style="color: ${config.primary_action_color || defaultConfig.primary_action_color};">0</span>
                </h2>
                <div id="flowerGarden" class="flex flex-wrap gap-3 justify-center mb-4"></div>
                
                <div class="text-center p-4 rounded-lg" style="background-color: ${config.background_color || defaultConfig.background_color};">
                  <div style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px;">
                    Bouquets Made: <span id="bouquetCount" class="font-bold" style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.5}px;">0</span>
                  </div>
                  <div id="bouquetDisplay" class="mt-3 flex gap-2 justify-center flex-wrap"></div>
                </div>
              </div>
              
              <!-- Result -->
              <div id="resultArea" class="hidden card-shadow rounded-2xl p-8 mb-6 text-center scale-in"
                style="background: linear-gradient(135deg, ${config.primary_action_color || defaultConfig.primary_action_color} 0%, ${config.secondary_action_color || defaultConfig.secondary_action_color} 100%);">
                <div id="resultText" class="font-bold" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 2}px;"></div>
              </div>
                            <!-- Time Complexity Section -->
              <div id="complexityArea" class="card-shadow rounded-2xl p-6 mb-6 fade-in"
                style="background-color: ${config.surface_color || defaultConfig.surface_color};">
                <h2 class="font-bold mb-4 flex items-center gap-2"
                  style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 1.4}px;">
                   Time & Space Complexity
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-center">
                  <div class="p-4 rounded-lg"
                    style="background-color: ${config.background_color || defaultConfig.background_color};">
                    <div class="font-semibold"
                      style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.1}px;">
                      Time Complexity
                    </div>
                    <div style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px;">
                      O(n log D)
                    </div>
                    <div style="opacity:0.7; font-size:${baseFontSize * 0.85}px; color:${config.text_color}">
                      n = flowers, D = day range
                    </div>
                  </div>

                  <div class="p-4 rounded-lg"
                    style="background-color: ${config.background_color || defaultConfig.background_color};">
                    <div class="font-semibold"
                      style="color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-size: ${baseFontSize * 1.1}px;">
                      Space Complexity
                    </div>
                    <div style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px;">
                      O(1)
                    </div>
                    <div style="opacity:0.7; font-size:${baseFontSize * 0.85}px; color:${config.text_color}">
                      Constant extra space
                    </div>
                  </div>
                </div>
              </div>

              <!-- Controls -->
              <div class="flex gap-4 justify-center">
                <button id="nextBtn" class="px-8 py-4 rounded-lg font-bold transition-all hover:scale-105"
                  style="background-color: ${config.primary_action_color || defaultConfig.primary_action_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px; box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);">
                  ${config.next_button || defaultConfig.next_button}
                </button>
                <button id="resetBtn" class="px-8 py-4 rounded-lg font-bold transition-all hover:scale-105"
                  style="background-color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize}px;">
                  ${config.reset_button || defaultConfig.reset_button}
                </button>
              </div>
              
            </div>
          </div>
        </div>
      `;
      
      setupEventListeners();
    }
    
    function setupEventListeners() {
      document.getElementById('startBtn').addEventListener('click', startAlgorithm);
      
      const nextBtn = document.getElementById('nextBtn');
      const resetBtn = document.getElementById('resetBtn');
      
      if (nextBtn) nextBtn.addEventListener('click', nextStep);
      if (resetBtn) resetBtn.addEventListener('click', resetAlgorithm);
    }
    
    function startAlgorithm() {
      const bloomDaysInput = document.getElementById('bloomDays').value;
      const m = parseInt(document.getElementById('bouquets').value);
      const k = parseInt(document.getElementById('adjacent').value);
      
      const bloomDays = bloomDaysInput.split(',').map(x => parseInt(x.trim()));
      
      if (bloomDays.some(isNaN) || isNaN(m) || isNaN(k)) {
        return;
      }
      
      const minDay = Math.min(...bloomDays);
      const maxDay = Math.max(...bloomDays);
      
      algorithmState = {
        bloomDays,
        m,
        k,
        originalLeft: minDay,
        originalRight: maxDay,
        steps: [],
        result: -1
      };
      
      generateSteps();
      currentStep = 0;
      
      document.getElementById('visualArea').classList.remove('hidden');
      document.getElementById('resultArea').classList.add('hidden');
      renderStep();
    }
    
    function generateSteps() {
      let left = algorithmState.originalLeft;
      let right = algorithmState.originalRight;
      
      while (left <= right) {
        const mid = Math.floor((left + right) / 2);
        const bouquets = countBouquets(algorithmState.bloomDays, mid, algorithmState.k);
        const canMake = bouquets >= algorithmState.m;
        
        algorithmState.steps.push({
          left,
          right,
          mid,
          canMake,
          bouquets,
          explanation: canMake 
            ? `‚úÖ Made ${bouquets} bouquets (need ${algorithmState.m}). Try earlier day ‚Üí search left [${left}, ${mid - 1}]`
            : `‚ùå Only ${bouquets} bouquets (need ${algorithmState.m}). Need more days ‚Üí search right [${mid + 1}, ${right}]`
        });
        
        if (canMake) {
          algorithmState.result = mid;
          right = mid - 1;
        } else {
          left = mid + 1;
        }
      }
    }
    
    function countBouquets(bloomDays, day, k) {
      let bouquets = 0;
      let flowers = 0;
      
      for (let bloomDay of bloomDays) {
        if (bloomDay <= day) {
          flowers++;
          if (flowers === k) {
            bouquets++;
            flowers = 0;
          }
        } else {
          flowers = 0;
        }
      }
      
      return bouquets;
    }
    
    function renderStep() {
      if (currentStep >= algorithmState.steps.length) {
        renderFinalResult();
        return;
      }
      
      const step = algorithmState.steps[currentStep];
      
      document.getElementById('stepCounter').textContent = `Step ${currentStep + 1} of ${algorithmState.steps.length}`;
      document.getElementById('leftVal').textContent = step.left;
      document.getElementById('midVal').textContent = step.mid;
      document.getElementById('rightVal').textContent = step.right;
      document.getElementById('currentDay').textContent = step.mid;
      document.getElementById('stepExplanation').innerHTML = `<div class="fade-in">${step.explanation}</div>`;
      
      renderSearchRange(step);
      renderFlowerGarden(step);
      renderBouquets(step);
    }
    
    function renderSearchRange(step) {
      const container = document.getElementById('searchRange');
      const baseFontSize = config.font_size || defaultConfig.font_size;
      
      let html = '<div class="flex items-center justify-center gap-1 flex-wrap">';
      
      for (let day = algorithmState.originalLeft; day <= algorithmState.originalRight; day++) {
        let bgColor, textColor, extraClass = '';
        
        if (day === step.mid) {
          bgColor = config.primary_action_color || defaultConfig.primary_action_color;
          textColor = config.text_color || defaultConfig.text_color;
          extraClass = 'pointer-arrow scale-in';
        } else if (day >= step.left && day <= step.right) {
          bgColor = config.secondary_action_color || defaultConfig.secondary_action_color;
          textColor = config.text_color || defaultConfig.text_color;
        } else {
          bgColor = config.background_color || defaultConfig.background_color;
          textColor = config.text_color || defaultConfig.text_color;
        }
        
        html += `<div class="day-cell ${extraClass} px-4 py-3 rounded-lg font-bold relative" 
          style="background-color: ${bgColor}; color: ${textColor}; font-size: ${baseFontSize}px; opacity: ${day >= step.left && day <= step.right ? '1' : '0.3'};">
          ${day}
        </div>`;
      }
      
      html += '</div>';
      container.innerHTML = html;
    }
    
    function renderFlowerGarden(step) {
      const container = document.getElementById('flowerGarden');
      const baseFontSize = config.font_size || defaultConfig.font_size;
      
      let html = '';
      algorithmState.bloomDays.forEach((bloomDay, index) => {
        const isBloomed = bloomDay <= step.mid;
        const emoji = isBloomed ? 'üå∏' : 'üå±';
        const extraClass = isBloomed ? 'flower-bloom bounce-animate' : '';
        
        html += `<div class="text-center ${extraClass}" style="min-width: 60px;">
          <div style="font-size: ${baseFontSize * 2.5}px;">${emoji}</div>
          <div class="font-semibold px-2 py-1 rounded" 
            style="background-color: ${isBloomed ? config.primary_action_color : config.secondary_action_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseFontSize * 0.75}px;">
            Day ${bloomDay}
          </div>
        </div>`;
      });
      
      container.innerHTML = html;
    }
    
    function renderBouquets(step) {
      const container = document.getElementById('bouquetDisplay');
      const baseFontSize = config.font_size || defaultConfig.font_size;
      
      document.getElementById('bouquetCount').textContent = step.bouquets;
      
      let html = '';
      for (let i = 0; i < step.bouquets; i++) {
       html += `
  <img src="bouquet.png"
       class="girl-animate"
       style="height:${baseFontSize * 6}px; width:auto; margin:6px;"
       alt="Girl giving bouquet">
`;


      }
      
      container.innerHTML = html;
    }
    
    function renderFinalResult() {
      const resultArea = document.getElementById('resultArea');
      const resultText = document.getElementById('resultText');
      const baseFontSize = config.font_size || defaultConfig.font_size;
      
      if (algorithmState.result !== -1) {
        resultText.innerHTML = `üéâ Minimum Days: <span style="font-size: ${baseFontSize * 3}px;">${algorithmState.result}</span>`;
      } else {
        resultText.innerHTML = `‚ùå Impossible to make ${algorithmState.m} bouquets`;
      }
      
      resultArea.classList.remove('hidden');
      
      document.getElementById('nextBtn').disabled = true;
      document.getElementById('nextBtn').style.opacity = '0.5';
    }
    
    function nextStep() {
      if (currentStep < algorithmState.steps.length) {
        currentStep++;
        renderStep();
      }
    }
    
    function resetAlgorithm() {
      currentStep = 0;
      algorithmState = null;
      document.getElementById('visualArea').classList.add('hidden');
      document.getElementById('nextBtn').disabled = false;
      document.getElementById('nextBtn').style.opacity = '1';
    }
    
    async function onConfigChange(newConfig) {
      Object.assign(config, newConfig);
      initializeUI();
      
      if (algorithmState) {
        renderStep();
      }
    }
    
    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => {
              config.background_color = value;
              window.elementSdk.setConfig({ background_color: value });
            }
          },
          {
            get: () => config.surface_color || defaultConfig.surface_color,
            set: (value) => {
              config.surface_color = value;
              window.elementSdk.setConfig({ surface_color: value });
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              config.text_color = value;
              window.elementSdk.setConfig({ text_color: value });
            }
          },
          {
            get: () => config.primary_action_color || defaultConfig.primary_action_color,
            set: (value) => {
              config.primary_action_color = value;
              window.elementSdk.setConfig({ primary_action_color: value });
            }
          },
          {
            get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
            set: (value) => {
              config.secondary_action_color = value;
              window.elementSdk.setConfig({ secondary_action_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => config.font_family || defaultConfig.font_family,
          set: (value) => {
            config.font_family = value;
            window.elementSdk.setConfig({ font_family: value });
          }
        },
        fontSizeable: {
          get: () => config.font_size || defaultConfig.font_size,
          set: (value) => {
            config.font_size = value;
            window.elementSdk.setConfig({ font_size: value });
          }
        }
      };
    }
    
    function mapToEditPanelValues(config) {
      return new Map([
        ["main_title", config.main_title || defaultConfig.main_title],
        ["problem_label", config.problem_label || defaultConfig.problem_label],
        ["start_button", config.start_button || defaultConfig.start_button],
        ["next_button", config.next_button || defaultConfig.next_button],
        ["reset_button", config.reset_button || defaultConfig.reset_button]
      ]);
    }
    
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
    
    initializeUI();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b251a3447093989',t:'MTc2NjQ2NDAwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
